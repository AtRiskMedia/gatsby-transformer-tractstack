{"version":3,"sources":["src/tractstack.js"],"names":["TractStack","data","context","TractStackContext","storystep","pixelWidth","local_storystep","JSON","parse","localStorage","getItem","setItem","stringify","value","relationships","field_storysteps","length","slidedeck","SlideDeck","name","filter","e","field_storystep_order","field_storystep_name","num_storysteps","Object","prototype","hasOwnProperty","call","Contents","children","Revealed","rows","Set","sort","a","b","row","map","slide","tractstack","toString","key","scrollRevealOptions","className","copy","svg_name","width","field_storystep_slides","svg","field_row_360","field_svg_360","field_row_1080","field_svg_1080","field_row_1920","field_svg_1920","parseInt","drupal_internal__nid","field_content","field_scroll_reveal_options","field_classname","ActionLink","button_text","action","handleClick","preventDefault","actions","nextStorystep","prevStorystep","TractStackSlide","allcopy","internal","type","clean","DOMPurify","sanitize","field_innerhtml","drupal_internal__id","__html","field_button_text","actions_payload","field_actions_payload","field_image","localFile","childImageSharp","gatsbyImageData","field_alt_text","pad","num","size","TrackStackController","storystep_name","svg__storystep","Controls","play","rew"],"mappings":"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","sourcesContent":["/* global localStorage */\n/* eslint-disable react/prop-types */\nimport React, {useContext} from 'react';\nimport {GatsbyImage, getImage} from 'gatsby-plugin-image';\nimport DOMPurify from 'dompurify';\nimport {SvgPane, SvgLogo, SvgPlay, SvgRewind} from './svg';\nimport {TractStackContext} from './provider';\nimport ScrollRevealContainer from './ScrollRevealContainer';\n\nexport function TractStack(data) {\n  //localStorage.clear();\n  const context = useContext(TractStackContext);\n  let storystep = context.storystep,\n    pixelWidth = context.pixelWidth;\n  const local_storystep = JSON.parse(localStorage.getItem('storystep'));\n  // if no context exists yet with storystep, use 1\n  if (!storystep) {\n    storystep = 1;\n    localStorage.setItem('storystep', JSON.stringify(1));\n    localStorage.setItem(\n      'num_storysteps',\n      JSON.stringify(data.value.relationships.field_storysteps.length)\n    );\n  } else if (local_storystep && storystep !== local_storystep) {\n    // use localStorage storystep if available\n    storystep = local_storystep;\n  }\n  let slidedeck = {\n    360: SlideDeck(360, storystep, data),\n    1080: SlideDeck(1080, storystep, data),\n    1920: SlideDeck(1920, storystep, data),\n    storystep: {\n      storystep: storystep,\n      name: data.value.relationships.field_storysteps.filter(\n        (e) => e.field_storystep_order === storystep\n      )[0].field_storystep_name,\n      num_storysteps: data.value.relationships.field_storysteps.length,\n    },\n  };\n\n  if (\n    pixelWidth &&\n    typeof slidedeck !== 'undefined' &&\n    typeof slidedeck == 'object' &&\n    Object.prototype.hasOwnProperty.call(slidedeck, 360) &&\n    Object.prototype.hasOwnProperty.call(slidedeck, 1080) &&\n    Object.prototype.hasOwnProperty.call(slidedeck, 1920) &&\n    Object.prototype.hasOwnProperty.call(slidedeck, 'storystep')\n  ) {\n    const Contents = ({children}) => <div>{children}</div>;\n    const Revealed = ScrollRevealContainer(Contents);\n\n    let rows = [\n      ...new Set(\n        slidedeck[pixelWidth]\n          .filter((e) => e.storystep === storystep)\n          .sort(function (a, b) {\n            return a.row - b.row;\n          })\n          .map(function (slide) {\n            return slide.row;\n          })\n      ),\n    ];\n    return (\n      <TractStackContext.Consumer>\n        {(tractstack) => (\n          <>\n            <div className={'pixelWidth__' + pixelWidth}>\n              <TrackStackController\n                value={{\n                  data: {\n                    slidedeck: slidedeck,\n                    context: tractstack,\n                  },\n                }}\n              />\n              {rows.map(function (row) {\n                return (\n                  <div\n                    className={\n                      'tractstack tractstack__container row' + row.toString()\n                    }\n                    key={row}\n                  >\n                    {slidedeck[pixelWidth]\n                      .filter((e) => e.storystep === storystep)\n                      .filter((e) => e.row === row)\n                      .map(function (slide) {\n                        // build slide\n                        return (\n                          <div className=\"pane .load-hidden\" key={slide.key}>\n                            <Revealed\n                              options={slide.scrollRevealOptions}\n                              interval={50}\n                              target={\n                                '.tractstack__container--' +\n                                slide.className +\n                                '-' +\n                                pixelWidth.toString()\n                              }\n                            >\n                              <>\n                                <TractStackSlide\n                                  value={{\n                                    key: slide.key,\n                                    copy: slide.copy,\n                                    svg_name: slide.svg_name,\n                                    className: slide.className,\n                                    pixelWidth: pixelWidth,\n                                  }}\n                                />\n                              </>\n                            </Revealed>\n                          </div>\n                        );\n                      })}\n                  </div>\n                );\n              })}\n            </div>\n          </>\n        )}\n      </TractStackContext.Consumer>\n    );\n  }\n  return <></>;\n}\n\nfunction SlideDeck(width, storystep, data) {\n  return data.value.relationships.field_storysteps\n    .filter((e) => e.field_storystep_order === storystep)[0]\n    .relationships.field_storystep_slides.map(function (e) {\n      let row, svg;\n      if (width === 360) {\n        row = e.field_row_360;\n        svg = e.field_svg_360;\n      } else if (width === 1080) {\n        row = e.field_row_1080;\n        svg = e.field_svg_1080;\n      } else if (width === 1920) {\n        row = e.field_row_1920;\n        svg = e.field_svg_1920;\n      } else return {};\n      if (row === -1) return {};\n      return {\n        key: parseInt(width.toString() + '0' + e.drupal_internal__nid),\n        storystep: storystep,\n        row: row,\n        copy: e.relationships.field_content,\n        scrollRevealOptions: e.field_scroll_reveal_options,\n        className: e.field_classname,\n        svg_name: svg,\n      };\n    });\n}\n\nfunction ActionLink(button_text, className, key, action) {\n  const context = useContext(TractStackContext);\n  function handleClick(e) {\n    e.preventDefault();\n    switch (action) {\n      case 'nextStorystep':\n        context.actions.nextStorystep();\n        break;\n      case 'prevStorystep':\n        context.actions.prevStorystep();\n        break;\n    }\n  }\n  return (\n    <div\n      className={\n        'pane pane__copy pane__copy--action pane__copy--action-' + className\n      }\n      key={key}\n    >\n      <div>\n        <button href=\"#\" onClick={handleClick} className=\"neon-button\">\n          {button_text}\n        </button>\n      </div>\n    </div>\n  );\n}\n\nfunction TractStackSlide(data) {\n  if (\n    typeof data !== 'undefined' &&\n    typeof data == 'object' &&\n    typeof data.value !== 'undefined' &&\n    typeof data.value.copy !== 'undefined' &&\n    typeof data.value.copy == 'object' &&\n    typeof data.value.svg_name !== 'undefined' &&\n    typeof data.value.svg_name == 'string' &&\n    typeof data.value.pixelWidth !== 'undefined' &&\n    typeof data.value.pixelWidth == 'number'\n  ) {\n    const allcopy = data.value.copy.map(function (copy) {\n      switch (copy.internal.type) {\n        case 'paragraph__text':\n          var clean = DOMPurify.sanitize(copy.field_innerhtml);\n          return (\n            <div\n              key={copy.drupal_internal__id}\n              className={'pane pane__copy pane__copy--' + copy.field_classname}\n            >\n              <div dangerouslySetInnerHTML={{__html: clean}}></div>\n            </div>\n          );\n        case 'paragraph__action':\n          var button_text = DOMPurify.sanitize(copy.field_button_text);\n          var actions_payload = JSON.parse(copy.field_actions_payload);\n          return ActionLink(\n            button_text,\n            copy.field_classname,\n            copy.drupal_internal__id,\n            actions_payload['action']\n          );\n        case 'paragraph__image':\n          return (\n            <div\n              key={copy.drupal_internal__id}\n              className={\n                'pane pane__image pane__imagemask--' + copy.field_classname\n              }\n            >\n              <GatsbyImage\n                image={getImage(\n                  copy.relationships.field_image.localFile.childImageSharp\n                    .gatsbyImageData\n                )}\n                className={'pane pane__image--' + copy.field_classname}\n                alt={copy.field_alt_text}\n              />\n            </div>\n          );\n      }\n    });\n    return (\n      <div\n        className={\n          'tractstack tractstack__container--' +\n          data.value.svg_name +\n          ' tractstack__container--' +\n          data.value.className +\n          '-' +\n          data.value.pixelWidth.toString()\n        }\n      >\n        <div\n          className={\n            'pane tractstack__svg tractstack__svg--' + data.value.className\n          }\n        >\n          {SvgPane(\n            data.value.pixelWidth.toString(),\n            data.value.svg_name,\n            data.value.className\n          )}\n        </div>\n        {allcopy}\n      </div>\n    );\n  }\n  return <></>;\n}\n\nfunction pad(num, size) {\n  num = num.toString();\n  while (num.length < size) num = '0' + num;\n  return num;\n}\n\nexport function TrackStackController(data) {\n  if (\n    typeof data !== 'undefined' &&\n    typeof data == 'object' &&\n    typeof data.value !== 'undefined' &&\n    typeof data.value.data !== 'undefined' &&\n    typeof data.value.data == 'object' &&\n    Object.prototype.hasOwnProperty.call(data.value.data.slidedeck, 360) &&\n    Object.prototype.hasOwnProperty.call(data.value.data.slidedeck, 1080) &&\n    Object.prototype.hasOwnProperty.call(data.value.data.slidedeck, 1920) &&\n    Object.prototype.hasOwnProperty.call(data.value.data.slidedeck, 'storystep')\n  ) {\n    const context = useContext(TractStackContext);\n    let pixelWidth = context.pixelWidth;\n    let num_storysteps = JSON.parse(localStorage.getItem('num_storysteps'));\n    let storystep = data.value.data.slidedeck.storystep.storystep;\n    let storystep_name = data.value.data.slidedeck.storystep.name;\n    let svg = SvgPane(pixelWidth.toString(), 'controller', 'controller');\n    let svg__storystep = SvgPane(\n      pixelWidth.toString(),\n      'controller',\n      'storystep',\n      'clip'\n    );\n    const Controls = () => {\n      let play = false,\n        rew = false;\n      if (storystep < num_storysteps) play = true;\n      if (storystep > 1) rew = true;\n      return (\n        <div className=\"pane\">\n          <div className=\"tractstack__controller--controls\">\n            {play && <SvgPlay value={context.actions.nextStorystep} />}\n            {rew && <SvgRewind value={context.actions.prevStorystep} />}\n          </div>\n        </div>\n      );\n    };\n\n    if (storystep && storystep_name && svg && svg__storystep) {\n      return (\n        <div className=\"tractstack tractstack__controller\">\n          <div className=\"pane tractstack__svg svg__controller\">{svg}</div>\n          <div className=\"pane tractstack__svg svg__storystep\">\n            {svg__storystep}\n          </div>\n          <div className=\"pane\">\n            <div className=\"tractstack__controller--storystep\">\n              <p>\n                Story\n                <br />\n                step\n              </p>\n              <div>{pad(storystep, 2)}</div>\n            </div>\n          </div>\n          <div className=\"pane\">\n            <div className=\"tractstack__controller--name\">\n              <SvgLogo /> <h1>{storystep_name}</h1>\n            </div>\n          </div>\n          <Controls />\n        </div>\n      );\n    }\n  }\n  return <></>;\n}\n"],"file":"tractstack.js"}